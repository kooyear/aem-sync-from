# This is a basic workflow to help you get started with Actions

name: CI

# Controls when the action will run. Triggers the workflow on push or pull request 
# events but only for the master branch
on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
    # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
    - uses: srt32/git-actions@v0.0.3
#       with:
#         persist-credentials: false
#     - name: Git-version
#       run: git version
#     - name: Git-remote-add
#       run: git remote add adobe https://github.com/kooyear/aem-sync-to.git
#     - name: Git-fetch-all
#       run: git fetch --all
#     - name: Git-checkout-adobe
#       run: git checkout -b sync-demo-master adobe/master
#     - name: set user
#       run: |
#         git config --global user.email "kooyear@gmail.com"
#         git config --global user.name "Ye-Gu"
#     - name: Git-merge
#       run: |
#         git merge master --allow-unrelated-histories
#         git fetch --unshallow origin
#     - name: Push changes
#       uses: ad-m/github-push-action@master
#       with:
# #        branch: sync-demo-master
#         github_token: ${{ secrets.PAT }}
#         repository: kooyear/aem-sync-to
#         force: true
    - name: Git-clone
      run: git clone https://github.com/kooyear/aem-sync-from.git
    - name: Red
      run: cd aem-sync-from
    - name: ls
      run: ls -a
    - name: Git-version
      run: git version
    - name: Git-remote-add
      run: |
        cd aem-sync-from
        git remote add adobe https://${{ secrets.PAT }}@github.com/kooyear/aem-sync-to.git
    - name: Git-checkout
      run: git checkout master
    - name: Git-fetch-all
      run: git fetch --all --prune --unshallow
    - name: ls
      run: ls -a
    - name: show-branches
      run: git show-branch -a -r
#     - name: Git-remote
#       run: git remote -v     
#     - name: Git-branches
#       run: git branch
#     - name: Git-checkout-adobe
#       run: git checkout -b sync-demo-master adobe/master
#     - name: Git-merge
#       run: git merge origin/master
#     - name: Git-push
#       run: git push --set-upstream adobe master
